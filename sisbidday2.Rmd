---
title: "SISBIDday2"
author: "Anju Menon"
date: "July 12, 2016"
output: html_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(devtools)
install_github("jennybc/googlesheets")
install.packages("googlesheets")
library(googlesheets)
```

Reading a google sheet

```{r}

sheets_url = "https://docs.google.com/spreadsheets/d/18KQQd4LY5k8Ucux1MvWCsQGQJlvd0ECTnn-3ixdOKFM/pubhtml"
aboutus = gs_url(sheets_url)
dat = gs_read(gsurl1)
date_acccesed=date()
date_acccesed
```
Look at the result

```{r lookatresult}
dat
```

Doing the lab
```{r}

aboutus = "https://docs.google.com/spreadsheets/d/103vUoftv2dLNZ_FcAz08b5ptIkWN4W2RaFn7VF39FJ8"
gsurl1 = gs_url(aboutus)
dat = gs_read(gsurl1,range=cell_cols(1:2))
date_acccesed=date()
date_acccesed
dat=gs_read(gsurl_about)
mean(as.numeric(dat$'Years of R experience'),na.rm=T)
logical_
```

Doing Json stuff now and install:

```{r}


install.packages("jsonlite")
library(jsonlite)
github_url = "https://api.github.com/users/jtleek/repos"
jsonData <- fromJSON(github_url)
dim(jsonData)
jsonData$name
names(jsonData)
```

Exploring Data
```{r}
sapply(jsonData,class)
table(sapply(jsonData,class))
dim(jsonData$owner) #dataframe inside a dataframe
names(jsonData$owner)
head(jsonData$owner)
jsonData$owner$html_url
```

Using JSON lab
```{r}
github_url_wic = "https://github.com/hadley/"
jsonData <- fromJSON(github_url_wic)
dim(jsonData)
jsonData$name
names(jsonData)
jsonData$stargazers_count
jsonData$issue_events_url
```

Web scraping:Data harvesting and make a table from the net into a dataframe
```{r}

install.packages("rvest")
library(rvest)
recount_url = "http://bowtie-bio.sourceforge.net/recount/"
htmlfile = read_html(recount_url)
htmlfile


nds = html_nodes(htmlfile,xpath='//*[@id="recounttab"]/table')
dat = html_table(nds)
dat = as.data.frame(dat)
head(dat)
names(dat)=dat[1,]
dat[-1,]
```

APIs


```{r}
install.packages("rfigshare")
library(rfigshare)
leeksearch = fs_search("Leek")
length(leeksearch)
leeksearch[[1]]

```

Install httr

```{r}
install.packages("httr")
library(httr)
query_url = "https://api.github.com/search/repositories?q=created:2014-08-13+language:r+-user:cran"
req = GET(query_url)
names(content(req))

```

Webscraping lab
```{r}
biocon_url = "https://raw.githubusercontent.com/SISBID/Module1/gh-pages/labs/bioc-software.html"
htmlfile = read_html(biocon_url)
htmlfile
nds = html_nodes(htmlfile,xpath='//*[@id="biocViews_package_table"]')
dat = html_table(nds)
dat = as.data.frame(dat)
head(dat)
names(dat)=dat[1,]
dat[-1,]

#system(".phantomjs scrape-bioc.js")

```

Install wordcloud
```{r}
install.packages(c("wordcloud","tm"))
library(wordcloud)
#text=paste(dat[,3],collapse="")
text=dat[,3]
wordcloud(text,max.words=50) #use top 50 words and make a wordcloud

```

API lab
```{r}
library(jsonlite)
oct4_dat = fromJSON("http://rest.ensembl.org//lookup/id/ENSG00000204531?content-type=application/json;expand=1")
dim(oct4_dat)
str(oct4_dat$Transcript)
oct4_dat$Transcript
#filter(oct4_dat,Transcript$id=='ENSG00000141510')


newgene_dat_dat=fromJSON("http://rest.ensembl.org//lookup/id/ENSG00000141510?content-type=application/json;expand=1")
str(newgene_dat_dat)

```

Get the gene info at https://rest.ensembl.org/documentation/info/symbol_lookup
attach base url + example code for symbol lookup
```{r}
braf_info=fromJSON("https://rest.ensembl.org//lookup/symbol/homo_sapiens/BRAF?content-type=application/json;expand=1")
braf_info$id # this is the symbol for gene BRAF
```
```{r}
ids=c("ENSG00000157764","ENSG00000141510")
dat=vector(2,mode="list")
for(i in 1:2){
base_url=
tail_url
url_want=paste0(base_url,ids[i],tail_url)
dat[[i]]=fromJSON()
print(url_want)
Sys.sleep(2)
}
```

July 12th : Afternoon Session(Data Cleaning Lab)
```{r}

```

